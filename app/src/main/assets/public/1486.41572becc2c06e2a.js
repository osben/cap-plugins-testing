"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1486],{1486:(L,m,c)=>{c.r(m),c.d(m,{FileManagerPage:()=>A});var l=c(1670),e=c(74),d=c(6477),_=c(9542),r=c(6463),f=c(6549);const h=(0,f.fo)("StorageVolumes",{});let p=(()=>{class i{constructor(t){this.loadingCtrl=t}showLoading(t={showBackdrop:!0}){var n=this;return(0,l.Z)(function*(){n.loading=yield n.loadingCtrl.create(t),n.loading.onWillDismiss().then(()=>{n.loading=null}),yield n.loading.present()})()}hideLoading(){var t=this;return(0,l.Z)(function*(){try{t.loading&&(yield t.loading.dismiss())}catch{}})()}isLoading(){return!!this.loading}autoHide(t){var n=this;return(0,l.Z)(function*(){n.loading=yield n.loadingCtrl.create({duration:t}),yield n.loading.present()})()}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(r.HT))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),P=(()=>{class i{transform(t){return(t=Number(t))>=1073741824?(t/1073741824).toFixed(2)+" GB":t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+" KB":t>1?t+" Bytes":t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=e.Yjl({name:"size",type:i,pure:!0,standalone:!0}),i})();const u=(0,f.fo)("Filesystem",{web:()=>c.e(5217).then(c.bind(c,5217)).then(i=>new i.FilesystemWeb)}),Z=(0,f.fo)("FileOpener");function F(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ion-item",3),e.NdJ("click",function(){const a=e.CHM(t).$implicit,g=e.oxw(2);return g.currentPath.set(a.path),e.KtG(g.basePath.set(a.path))}),e._UZ(1,"ion-icon",4),e.TgZ(2,"ion-label")(3,"h3"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"size"),e.ALo(10,"size"),e.qZA()()()}if(2&i){const t=s.$implicit;e.xp6(4),e.Oqu(t.name),e.xp6(2),e.Oqu(t.path),e.xp6(2),e.AsE("",e.lcZ(9,4,t.totalBytes-t.freeBytes)," used of ",e.lcZ(10,6,t.totalBytes),"")}}function x(i,s){if(1&i&&(e.TgZ(0,"ion-list"),e.YNc(1,F,11,8,"ion-item",2),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.storageDirectories())}}function y(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ion-item-sliding")(1,"ion-item",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.openDir(o))}),e._UZ(2,"ion-icon",9),e.TgZ(3,"ion-label")(4,"h3"),e._uU(5),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.ALo(8,"size"),e.ALo(9,"date"),e.qZA()()()()}if(2&i){const t=e.oxw(),n=t.last,o=t.$implicit;e.xp6(1),e.Q6J("lines",n?"none":"full"),e.xp6(4),e.Oqu(o.name),e.xp6(2),e.AsE("",e.lcZ(8,4,o.size)," ",e.lcZ(9,6,o.ctime),"")}}function T(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ion-item",10),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.clickFile(o))}),e._UZ(1,"ion-icon",11),e.TgZ(2,"ion-label")(3,"h3"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.ALo(7,"date"),e.qZA()()()}if(2&i){const t=e.oxw().$implicit;e.xp6(4),e.Oqu(t.name),e.xp6(2),e.AsE("",t.size," ",e.lcZ(7,3,t.ctime),"")}}function k(i,s){if(1&i&&(e.ynx(0),e.YNc(1,y,10,8,"ion-item-sliding",1),e.YNc(2,T,8,5,"ion-item",7),e.BQk()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngIf",!t.isFile),e.xp6(1),e.Q6J("ngIf",t.isFile)}}function v(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ion-list")(1,"ion-item",3),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.back())}),e._UZ(2,"ion-icon",5),e.TgZ(3,"ion-label"),e._uU(4," ..."),e.qZA()(),e.YNc(5,k,3,2,"ng-container",6),e.qZA()}if(2&i){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.filesList())}}function M(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ion-footer")(1,"ion-toolbar",12)(2,"ion-button",3),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.testCreateFile())}),e._uU(3,"Test create file"),e.qZA()()()}}let A=(()=>{class i{constructor(){var t=this;this.platform=(0,e.f3M)(r.t4),this.loading=(0,e.f3M)(p),this.alertCtrl=(0,e.f3M)(r.Br),this.storageDirectories=(0,e.tdS)(null),this.currentPath=(0,e.tdS)(""),this.filesList=(0,e.tdS)([]),this.basePath=(0,e.tdS)(""),this.canGoBack=(0,e.tdS)(!1),(0,e.cEC)((0,l.Z)(function*(){console.log(`The currentPath is: ${t.currentPath()})`),t.currentPath()&&(yield t.loadDocuments())}))}ionViewWillEnter(){var t=this;return(0,l.Z)(function*(){(yield t.checkPermissions())&&(yield t.platform.ready(),yield t.getVolumes())})()}ngOnInit(){}checkPermissions(){return(0,l.Z)(function*(){return!("denied"===(yield u.checkPermissions()).publicStorage&&"denied"===(yield u.requestPermissions()).publicStorage)})()}getVolumes(){var t=this;return(0,l.Z)(function*(){var n;t.storageDirectories.set(null);const o=yield h.getVolumes();t.storageDirectories.set(null!==(n=null==o?void 0:o.volumes)&&void 0!==n?n:null)})()}openDir(t){var n=this;return(0,l.Z)(function*(){const o=""!==n.currentPath()?`${n.currentPath()}/${t.name}`:t.name;console.log(`Opening path: ${o}`,t),n.currentPath.set(o)})()}loadDocuments(){var t=this;return(0,l.Z)(function*(){console.log(`Loading documents from path: ${t.currentPath()}`),yield u.requestPermissions(),t.filesList.set([]),t.canGoBack.set(t.checkGoBack());try{let o=(yield u.readdir({path:t.currentPath()})).files.map(a=>({...a,isFile:a.name.includes("."),format:a.name.split(".").pop()}));console.log(o),t.filesList.set(o),yield t.loading.hideLoading()}catch(n){const o=yield t.alertCtrl.create({header:n.message,backdropDismiss:!1,buttons:[{text:"back",role:"ok",handler:(a=(0,l.Z)(function*(){yield t.back()}),function(){return a.apply(this,arguments)})},{text:"To select storage",role:"ok",handler:function(){var a=(0,l.Z)(function*(){t.basePath.set(""),t.currentPath.set("")});return function(){return a.apply(this,arguments)}}()}]});yield t.loading.hideLoading(),yield o.present()}var a})()}back(){var t=this;return(0,l.Z)(function*(){if(t.canGoBack()){yield t.loading.showLoading();const n=t.currentPath().split("/");let o="";n.length>1&&(n.splice(-1),o=n.join("/")),t.currentPath.set(o),yield t.loading.hideLoading()}else t.currentPath.set(""),t.basePath.set("")})()}clickFile(t){return(0,l.Z)(function*(){yield Z.open({filePath:t.uri})})()}checkGoBack(){return this.currentPath().length>this.basePath().length||(this.currentPath.set(this.basePath()),!1)}testCreateFile(){var t=this;return(0,l.Z)(function*(){const o=`test-${Math.floor(1e5*Math.random())}.txt`;(yield u.writeFile({path:`${t.currentPath()}/${o}`,data:"data:text/plain;base64,SGVsbG8sIFdvcmxkIQ=="}))?yield t.loadDocuments():console.log("error")})()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-file-manager"]],standalone:!0,features:[e.jDz],decls:10,vars:3,consts:[["slot","start"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["name","file-tray-full-outline","slot","start"],["name","arrow-undo-outline","slot","start","size","small"],[4,"ngFor","ngForOf"],["detail","false","button","true",3,"click",4,"ngIf"],["button","true","detail","true",3,"lines","click"],["name","folder","slot","start","size","small"],["detail","false","button","true",3,"click"],["name","document","slot","start","size","small"],[1,"ion-text-center"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Volumes plugin"),e.qZA()()(),e.TgZ(6,"ion-content"),e.YNc(7,x,2,1,"ion-list",1),e.YNc(8,v,6,1,"ion-list",1),e.qZA(),e.YNc(9,M,4,0,"ion-footer",1)),2&t&&(e.xp6(7),e.Q6J("ngIf",!n.currentPath()),e.xp6(1),e.Q6J("ngIf",n.currentPath()),e.xp6(1),e.Q6J("ngIf",n.currentPath()))},dependencies:[r.Pc,r.YG,r.Sm,r.W2,r.fr,r.Gu,r.gu,r.Ie,r.td,r.Q$,r.q_,r.fG,r.wd,r.sr,d.ez,d.sg,d.O5,d.uU,_.u5,P]}),i})()}}]);